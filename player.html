<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moonfin - Player</title>
    <link rel="stylesheet" href="css/legacy-compat.css">
    <link rel="stylesheet" href="css/player.css">
    <script src="js/tizen-adapter.js" charset="utf-8"></script>
    <script src="shaka-player.js" charset="utf-8"></script>
    <script src="js/polyfills.js" charset="utf-8"></script>
    <script src="js/storage.js" charset="utf-8"></script>
    <script src="js/accent-color.js" charset="utf-8"></script>
    <script src="js/ajax.js" charset="utf-8"></script>
    <script src="js/keycodes.js" charset="utf-8"></script>
    <script src="js/jellyfin-api.js" charset="utf-8"></script>
    <script src="js/multi-server.js" charset="utf-8"></script>
    <script src="js/connection-pool.js" charset="utf-8"></script>
    <script src="js/track-selector.js" charset="utf-8"></script>
    <script src="js/video-player-adapter.js" charset="utf-8"></script>
    <script src="js/player.js" charset="utf-8"></script>
</head>
<body>
    <video id="videoPlayer" class="video-player" preload="metadata"></video>
    
    <!-- Video darkening overlay -->
    <div id="videoDimmer" class="video-dimmer"></div>
    
    <!-- Playback indicators -->
    <div class="playback-indicators">
        <div id="speedIndicator" class="speed-indicator" style="display: none;">1.0x</div>
        <div id="bitrateIndicator" class="bitrate-indicator" style="display: none;">0 Mbps</div>
    </div>
    
    <!-- Skip Overlay -->
    <div id="skipOverlay" class="skip-overlay" style="display: none;">
        <div class="skip-button-container">
            <button id="skipButton" class="skip-button" tabindex="0">
                <span id="skipButtonText">Skip Intro</span>
                <span id="skipButtonTime" class="skip-button-time"></span>
            </button>
        </div>
    </div>
    
    <!-- Player Controls Overlay -->
    <div id="playerControls" class="player-controls">
        <div class="controls-top">
            <div class="media-info">
                <img id="mediaLogo" class="media-logo" alt="" style="display: none;">
                <h1 id="mediaTitle" class="media-title" style="display: none;"></h1>
                <p id="mediaSubtitle" class="media-subtitle"></p>
            </div>
        </div>
        
        <div class="controls-bottom">
            <div class="control-buttons">
                <button id="playPauseBtn" class="control-btn" tabindex="0">
                    <img src="assets/pause.png" alt="Play/Pause" class="btn-icon">
                </button>
                <button id="rewindBtn" class="control-btn" tabindex="0">
                    <img src="assets/rewinds.png" alt="Rewind" class="btn-icon">
                </button>
                <button id="forwardBtn" class="control-btn" tabindex="0">
                    <img src="assets/fast_forward.png" alt="Forward" class="btn-icon">
                </button>
                <button id="audioBtn" class="control-btn" tabindex="0">
                    <img src="assets/select_audio.png" alt="Audio" class="btn-icon">
                </button>
                <button id="subtitleBtn" class="control-btn" tabindex="0">
                    <img src="assets/subtitle.png" alt="Subtitles" class="btn-icon">
                </button>
                <button id="playModeBtn" class="control-btn" tabindex="0">
                    <img src="assets/request_hd.png" alt="Play Mode" class="btn-icon">
                </button>
            </div>
            
            <div class="progress-container">
                <div class="time-info-top">
                    <span id="endTime" class="time-end">Ends at 0:00</span>
                </div>
                <div id="progressBar" class="progress-bar">
                    <div id="progressFill" class="progress-fill"></div>
                    <div id="seekIndicator" class="seek-indicator"></div>
                </div>
                <div class="time-info">
                    <span id="timeDisplay" class="time-display">0:00 / 0:00</span>
                </div>
            </div>
            
            <div class="control-buttons-bottom">
                <button id="chaptersBtn" class="control-btn" tabindex="0">
                    <img src="assets/select_chapter.png" alt="Chapters" class="btn-icon">
                </button>
                <button id="previousItemBtn" class="control-btn" tabindex="0">
                    <img src="assets/previous.png" alt="Previous Item" class="btn-icon">
                </button>
                <button id="nextItemBtn" class="control-btn" tabindex="0">
                    <img src="assets/play_next.png" alt="Next Item" class="btn-icon">
                </button>
                <button id="speedBtn" class="control-btn" tabindex="0">
                    <img src="assets/playback_speed.png" alt="Speed" class="btn-icon">
                </button>
                <button id="qualityBtn" class="control-btn" tabindex="0">
                    <img src="assets/request_hd.png" alt="Quality" class="btn-icon">
                </button>
                <button id="videoInfoBtn" class="control-btn" tabindex="0">
                    <img src="assets/trailer.png" alt="Video Info" class="btn-icon">
                </button>
            </div>
        </div>
    </div>
    
    <!-- Audio Track Selection Modal -->
    <div id="audioModal" class="track-modal">
        <div class="modal-content">
            <h2 class="modal-title">Select Audio Track</h2>
            <div id="audioTrackList" class="track-list"></div>
        </div>
    </div>
    
    <!-- Subtitle Track Selection Modal -->
    <div id="subtitleModal" class="track-modal">
        <div class="modal-content">
            <h2 class="modal-title">Select Subtitle</h2>
            <div id="subtitleTrackList" class="track-list"></div>
        </div>
    </div>
    
    <!-- Playback Speed Selection Modal -->
    <div id="speedModal" class="track-modal">
        <div class="modal-content">
            <h2 class="modal-title">Playback Speed</h2>
            <div id="speedList" class="track-list"></div>
        </div>
    </div>
    
    <!-- Quality/Bitrate Selection Modal -->
    <div id="qualityModal" class="track-modal">
        <div class="modal-content">
            <h2 class="modal-title">Max Bitrate</h2>
            <div id="qualityList" class="track-list"></div>
        </div>
    </div>
    
    <!-- Chapters Modal -->
    <div id="chaptersModal" class="track-modal">
        <div class="modal-content chapters-modal">
            <h2 class="modal-title">Chapters</h2>
            <div id="chaptersContent" class="chapters-content"></div>
            <div class="chapters-footer">
                <p style="text-align: center; opacity: 0.7; margin-top: 20px;">Press BACK to close</p>
            </div>
        </div>
    </div>
    
    <!-- Video Info Modal -->
    <div id="videoInfoModal" class="track-modal">
        <div class="modal-content video-info-modal">
            <h2 class="modal-title">Playback Information</h2>
            <div id="videoInfoContent" class="video-info-content"></div>
            <div class="video-info-footer">
                <p style="text-align: center; opacity: 0.7; margin-top: 20px;">Press BACK to close</p>
            </div>
        </div>
    </div>
    
    <!-- Play Mode Selection Modal -->
    <div id="playModeModal" class="track-modal">
        <div class="modal-content">
            <h2 class="modal-title">Play Mode</h2>
            <div id="playModeList" class="track-list"></div>
        </div>
    </div>
    
    <div id="loadingIndicator" class="loading-indicator">
        <div class="spinner"></div>
        <p>Loading...</p>
    </div>

    <!-- Error Dialog -->
    <div id="errorDialog" class="error-dialog" style="display: none;">
        <div class="error-dialog-content">
            <div class="error-dialog-icon">⚠️</div>
            <h2 class="error-dialog-title" id="errorDialogTitle">Playback Error</h2>
            <p class="error-dialog-message" id="errorDialogMessage"></p>
            <div class="error-dialog-details" id="errorDialogDetails" style="display: none;"></div>
            <div class="error-dialog-actions">
                <button id="errorDialogBtn" class="error-dialog-button" tabindex="0">OK</button>
            </div>
        </div>
    </div>
</body>
</html>
